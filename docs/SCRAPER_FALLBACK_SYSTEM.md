# ๐ ูุธุงู Fallback ุงูุฐูู ููุณูุฑูุจุฑุฒ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู **Fallback ุชููุงุฆู** ุฐูู ูุฏูุฑ ูุตุงุฏุฑ ุงููุญุชูู ุงููุชุนุฏุฏุฉ ูุน ุงูุชุจุฏูู ุงูุชููุงุฆู ุนูุฏ ูุดู ุฃู ูุตุฏุฑ.

---

## ๐ฏ ุงููุดููุฉ ูุงูุญู

### ุงููุดููุฉ:

- **Larooza** ู **MyCima** โ ููุณ ุงููุญุชูู (ุฃููุงู ููุณูุณูุงุช ุนุฑุจูุฉ)
- ุฅุฐุง ูููุน ููุนุ ุงููุณุชุฎุฏููู ูุง ููุฏุฑูุง ูุดูููุง ุงููุญุชูู

### ุงูุญู:

โ **ูุธุงู Fallback ุชููุงุฆู**:

- ูู Larooza ููุน โ ูุนุฑุถ ูู MyCima ุชููุงุฆูุงู
- ูู MyCima ููุน โ ูุนุฑุถ ูู Larooza ุชููุงุฆูุงู
- **ุจุฏูู ุชุฏุฎู ูุฏูู!**

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### 1. **Backend - Scraper Manager**

๐ `backend/app/core/scraper_manager.py`

**ุงููููุฒุงุช:**

- โ ุชุชุจุน ุญุงูุฉ ูู scraper (Online/Offline)
- โ ูุญุต ุตุญุฉ ุชููุงุฆู (Health Check)
- โ ูุธุงู ุฃููููุงุช (Priority System)
- โ ุญุณุงุจ Health Score ููู scraper
- โ Fallback ุชููุงุฆู ุนูุฏ ุงููุดู

**Scrapers ุงููุชุงุญุฉ:**

```python
{
    # Arabic Content (Movies & Series)
    "larooza": Priority 1 (Primary)
    "mycima": Priority 2 (Fallback)

    # Anime Content
    "anime4up": Priority 1 (Primary)
    "animerco": Priority 2 (Fallback)
}
```

### 2. **API Endpoints**

๐ `backend/app/api/endpoints/scrapers.py`

| Endpoint                 | Method | ุงููุตู                        |
| ------------------------ | ------ | ---------------------------- |
| `/scrapers/status`       | GET    | ุฌูุจ ุญุงูุฉ ุฌููุน ุงูุณูุฑูุจุฑุฒ      |
| `/scrapers/check-health` | POST   | ูุญุต ุตุญุฉ ุงูุณูุฑูุจุฑุฒ ูุฏููุงู     |
| `/scrapers/toggle`       | POST   | ุชูุนูู/ุชุนุทูู scraper          |
| `/scrapers/set-priority` | POST   | ุชุบููุฑ ุงูุฃููููุฉ               |
| `/scrapers/available`    | GET    | ุงูุญุตูู ุนูู ุงูุณูุฑูุจุฑุฒ ุงููุชุงุญุฉ |

### 3. **Frontend - Scrapers Manager**

๐ `meih-netflix-clone/src/pages/ScrapersManager.tsx`

**ุงููุงุฌูุฉ:**

- ๐ ุฅุญุตุงุฆูุงุช ุนุงูุฉ (ุฅุฌูุงููุ ุดุบุงูุ ูุงููุ ุงูุตุญุฉ)
- ๐๏ธ ุจุทุงูุงุช ุชูุงุนููุฉ ููู scraper
- โก ุชูุนูู/ุชุนุทูู ุจุถุบุทุฉ ูุงุญุฏุฉ
- ๐ผ๐ฝ ุชุบููุฑ ุงูุฃููููุฉ
- ๐ ูุญุต ุตุญุฉ ูุฏูู
- โฑ๏ธ ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุงููุตูู ูุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุฑุฒ

**ูู ุงูุฏุงุดุจูุฑุฏ:**

```
http://localhost:5173/admin
```

- ุงุถุบุท ุนูู "ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุฑุฒ" ูู ูุณู ุงูุฅุนุฏุงุฏุงุช ุงูุณุฑูุนุฉ

**ูุจุงุดุฑุฉ:**

```
http://localhost:5173/admin/scrapers
```

### 2. ูุฑุงูุจุฉ ุงูุญุงูุฉ

**ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ:**

- ๐ **ุฅุฌูุงูู ุงูุณูุฑูุจุฑุฒ**: ุนุฏุฏ ุงูุณูุฑูุจุฑุฒ ุงููุณุฌูุฉ
- โ **ุดุบุงู**: ุงูุณูุฑูุจุฑุฒ ุงููุชุตูุฉ
- โ **ูุงูู**: ุงูุณูุฑูุจุฑุฒ ุงููุนุทูุฉ
- ๐ **ุงูุตุญุฉ ุงูุนุงูุฉ**: ูุณุจุฉ ุงูุณูุฑูุจุฑุฒ ุงูุดุบุงูุฉ

**ููู Scraper:**

- ๐ข **ูุชุตู** / ๐ด **ุบูุฑ ูุชุตู**
- ๐ **ุงูุฃููููุฉ**: #1, #2, #3...
- ๐ฏ **ุงูุตุญุฉ**: 0-100%
- โก **ุงูุงุณุชุฌุงุจุฉ**: ุจุงููููู ุซุงููุฉ
- โโ **ุงูุฅุญุตุงุฆูุงุช**: ุนุฏุฏ ุงููุฌุงุญุงุช ูุงูุฃุฎุทุงุก

### 3. ุงูุชุญูู ูู ุงูุณูุฑูุจุฑุฒ

#### ุชูุนูู/ุชุนุทูู:

- ุงุถุบุท ุนูู ุฒุฑ Toggle (๐) ูู ุฃุนูู ูููู ุงูุจุทุงูุฉ
- ๐ข ุฃุฎุถุฑ = ููุนู
- โช ุฑูุงุฏู = ูุนุทู

#### ุชุบููุฑ ุงูุฃููููุฉ:

- ุงุถุบุท โฌ๏ธ ูุฑูุน ุงูุฃููููุฉ (ุฑูู ุฃูู = ุฃููููุฉ ุฃุนูู)
- ุงุถุบุท โฌ๏ธ ูุฎูุถ ุงูุฃููููุฉ

#### ูุญุต ุงูุตุญุฉ:

- ุงุถุบุท "ูุญุต ุงูุญุงูุฉ" ูู ุงูุฃุนูู
- ุณูุชู ูุญุต ุฌููุน ุงูุณูุฑูุจุฑุฒ ููุฑุงู

---

## ๐ ููู ูุนูู Fallbackุ

### ุงูุณููุงุฑูู 1: Larooza ูุนูู ุจุดูู ุทุจูุนู

```
User Request โ Check Larooza (Priority 1) โ โ Online โ Use Larooza
```

### ุงูุณููุงุฑูู 2: Larooza ูุงูู

```
User Request โ Check Larooza (Priority 1) โ โ Offline
            โ Check MyCima (Priority 2) โ โ Online โ Use MyCima
```

### ุงูุณููุงุฑูู 3: ููุงููุง ูุงูู

```
User Request โ Check Larooza โ โ Offline
            โ Check MyCima โ โ Offline
            โ Return Error: "ูุง ุชูุฌุฏ ูุตุงุฏุฑ ูุชุงุญุฉ ุญุงููุงู"
```

---

## ๐ Health Score System

**ููู ูุชู ุญุณุงุจ ุงูุตุญุฉุ**

```javascript
Health Score = (Success Rate ร 100) - Response Time Penalty

Success Rate = (Success Count / Total Requests) ร 100
Response Time Penalty = min(Response Time / 10, 20) // Max 20 points
```

**ูุซุงู:**

- Success: 95 requests
- Errors: 5 requests
- Response Time: 150ms

```
Success Rate = (95 / 100) ร 100 = 95%
Time Penalty = min(150 / 10, 20) = 15
Health Score = 95 - 15 = 80%
```

**ุงูุชุตููู:**

- ๐ข **80-100%**: ููุชุงุฒ
- ๐ก **50-79%**: ุฌูุฏ
- ๐ด **0-49%**: ุถุนูู

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ

### ุชุบููุฑ URL ุงูุณูุฑูุจุฑ

ูู `backend/app/core/scraper_manager.py`:

```python
self.scrapers["mycima"] = ScraperStatus(
    name="MyCima",
    url="https://mycima.tv",  # ุบูุฑ ููุง
    enabled=True,
    priority=2
)
```

### ุฅุถุงูุฉ Scraper ุฌุฏูุฏ

```python
self.scrapers["new_scraper"] = ScraperStatus(
    name="New Scraper",
    url="https://example.com",
    enabled=True,
    priority=3
)
```

### ุชุบููุฑ ููุช ุงููุญุต ุงูุชููุงุฆู

ูู `ScrapersManager.tsx`:

```typescript
// Auto-refresh every 30 seconds
const interval = setInterval(fetchScrapers, 30000); // ุบูุฑ 30000 ููููุช ุงููุทููุจ
```

---

## ๐ ุงูุฃูุงู

**ุญูุงูุฉ ุงูู Endpoints:**

- โ ุฌููุน endpoints ูุญููุฉ ุจู Admin Token
- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู ูู ุทูุจ
- โ `/scrapers/available` ููุท ูู Public (ููุงุณุชุฎุฏุงู ูู Frontend)

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงููุฑุงูุจุฉ

### Real-time Monitoring:

- โฑ๏ธ **ุขุฎุฑ ูุญุต**: ููุช ุขุฎุฑ health check
- ๐ **ูุนุฏู ุงููุฌุงุญ**: ูุณุจุฉ ุงูุทูุจุงุช ุงููุงุฌุญุฉ
- โก **ุฒูู ุงูุงุณุชุฌุงุจุฉ**: ุณุฑุนุฉ ุงูุณูุฑูุจุฑ
- ๐ **ุนุฏุฏ ุงูุฃุฎุทุงุก**: ุงูุฃุฎุทุงุก ุงููุชุฑุงููุฉ

### Auto-refresh:

- ูู 30 ุซุงููุฉ ูุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุชููุงุฆูุงู
- ูููู ุงูุชุญุฏูุซ ูุฏููุงู ุจุถุบุทุฉ ุฒุฑ

---

## ๐จ ุงููุงุฌูุฉ

### ุงูุฃููุงู:

- ๐ข **ุฃุฎุถุฑ**: Online / Enabled / Success
- ๐ด **ุฃุญูุฑ**: Offline / Error
- ๐ก **ุฃุตูุฑ**: Warning / Medium Health
- ๐ต **ุฃุฒุฑู**: Info / Priority
- โช **ุฑูุงุฏู**: Disabled

### ุงูุฃููููุงุช:

- ๐ฌ **Larooza**
- ๐ญ **MyCima**
- โก **Anime4Up**
- ๐ฅ **AnimeRCO**

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: Scraper ูุธูุฑ Offline ุฑุบู ุฃูู ูุนูู

**ุงูุญู:**

1. ุงุถุบุท "ูุญุต ุงูุญุงูุฉ" ููุชุญุฏูุซ
2. ุชุญูู ูู ุงูู URL ูู `scraper_manager.py`
3. ุชุญูู ูู ุงูู firewall/proxy settings

### ุงููุดููุฉ: Fallback ูุง ูุนูู

**ุงูุญู:**

1. ุชุฃูุฏ ุฃู Priority ูุฎุชููุฉ ููู scraper
2. ุชุฃูุฏ ุฃู Fallback scraper ููุนู (Enabled)
3. ุชุญูู ูู ุงูู logs ูู Backend

### ุงููุดููุฉ: Health Score ููุฎูุถ

**ุงูุญู:**

1. ุชุญูู ูู ุณุฑุนุฉ ุงูุฅูุชุฑูุช
2. ุชุญูู ูู ุงุณุชูุฑุงุฑ ุงููููุน ุงููุตุฏุฑ
3. ููู ุนุฏุฏ ุงูุทูุจุงุช ุงููุชุฒุงููุฉ

---

## ๐ ุงููููุงุช ุงููููุฉ

```
backend/
โโโ app/
โ   โโโ core/
โ   โ   โโโ scraper_manager.py        # โญ Scraper Manager Core
โ   โโโ api/
โ       โโโ endpoints/
โ           โโโ scrapers.py            # โญ API Endpoints

frontend/
โโโ src/
    โโโ pages/
        โโโ AdminDashboard.tsx         # ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ
        โโโ ScrapersManager.tsx        # โญ ุฅุฏุงุฑุฉ ุงูุณูุฑูุจุฑุฒ
```

---

## ๐ ุงูุชุทููุฑ ุงููุณุชูุจูู

### ุฃููุงุฑ ููุชุญุณูู:

- [ ] ุฅุถุงูุฉ Webhooks ููุฅุดุนุงุฑุงุช ุนูุฏ ูุดู scraper
- [ ] ุฑุณูู ุจูุงููุฉ ูุชุชุจุน ุงูุฃุฏุงุก
- [ ] Auto-disable ููุณูุฑูุจุฑุฒ ุงููุนุทูุฉ ููุชุฑุฉ ุทูููุฉ
- [ ] Load Balancing ุจูู ุงูุณูุฑูุจุฑุฒ
- [ ] Cache ูููุชุงุฆุฌ ูุชูููู ุงูุทูุจุงุช
- [ ] Retry mechanism ูุน exponential backoff
- [ ] Logging ููุตู ููู ุนูููุฉ

---

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ**: Antigravity AI  
**ุงูุชุงุฑูุฎ**: 2026-01-13  
**ุงูุฅุตุฏุงุฑ**: 1.0.0
